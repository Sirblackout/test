# Load your CVM list
$cvmList = Get-Content .\cvm_list.txt
$user = "nutanix" # Change if your user is different
$outputFile = ".\all_clusters_nics.txt"

# Clear previous output
if (Test-Path $outputFile) { Remove-Item $outputFile }

foreach ($cvm in $cvmList) {
    Add-Content $outputFile "======== $cvm ========"
    # Run the SSH command and append output
    $result = ssh $user@$cvm "hostssh 'lspci | grep -i ethernet'"
    Add-Content $outputFile $result
    Add-Content $outputFile ""
}
Write-Host "Done. See $outputFile"


